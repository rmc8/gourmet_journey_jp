# 詳細機能仕様ヒアリング

## ヒアリング日時
- **日付**: 2025-06-14
- **ステータス**: 進行中

## 重要な確認事項

### Q1: 購入と食事完了の2段階管理について 🔍
**現状の理解**:
- 購入時点では評価ができない
- ルーレットは「お取り寄せ済み」基準で判定
- しかし評価は「食事完了」時点で入力

**提案するデータ構造**:
```javascript
お取り寄せ記録 {
  id: string,
  商品名: string,
  商品URL?: string,
  注文日: Date,
  都道府県: string,
  価格?: number,
  購入先URL?: string,
  ショップ名?: string,
  
  // ステータス管理
  ステータス: "購入済み" | "食事完了",
  
  // 食事完了時のみ入力
  評価?: number (1-5),
  写真URL?: string,
  食事日?: Date,
  メモ?: string
}
```

**質問**:
1. このデータ構造で良いでしょうか？
2. ヒートマップは「購入回数」「食事完了回数」どちらをベースにしますか？
3. ルーレットは「購入済み」の都道府県を対象にしますか？
4. 統計・分析では両方のカウントを表示しますか？

**回答**: 評価は整数型で0を未評価、1~5を評価したという扱いで良いと思います。それであればnullを回避できます。ヒートマップは完了回数をベースにしてください。ルーレットは購入回数が最も少ない都道府県から選択されることを意図しています。統計では両方を積み上げグラフのような形式で表示しましょう。

### Q2: ユーザーフローの詳細
**想定されるフロー**:
1. ルーレットで都道府県選択
2. 外部検索で商品発見
3. 購入完了→「購入済み」として記録
4. 商品到着・食事完了→ステータス更新・評価入力

**質問**:
1. 購入記録の入力タイミングはいつが最適ですか？
2. 「購入済み」から「食事完了」への更新は別画面ですか？
3. 購入記録と食事記録を同時に入力することもありますか？

**回答**: [待機中]

### Q3: 検索・フィルター機能の詳細
**提案する検索機能**:
- **都道府県別**: プルダウンで選択
- **評価フィルター**: スライダーで範囲指定（例：4-5点のみ）
- **日付範囲**: カレンダーで期間指定
- **商品名検索**: 部分一致検索
- **ステータス**: 「購入済み」「食事完了」「全て」

**質問**:
1. 複数条件でのAND検索が必要ですか？
2. 並び順（日付順、評価順など）の指定は必要ですか？
3. 検索結果の表示形式（リスト、カード、テーブル）に希望はありますか？

**回答**: AND条件で良いと思います。ソートはあるとよいですがデフォルト購入日の降順です。表示形式はテーブルとリストがつかえるとよいです。テーブルが最優先です。

### Q4: 統計・分析機能の詳細
**提案する統計機能**:
1. **月別グラフ**: 購入回数・食事完了回数を分けて表示
2. **評価分析**: 都道府県別平均評価、全体平均
3. **支出分析**: 月別支出、都道府県別平均価格
4. **制覇状況**: 
   - 購入制覇率（47都道府県中何県購入済み）
   - 食事制覇率（47都道府県中何県食事完了）
   - 周回数（最低回数の都道府県基準）

**質問**:
1. グラフの種類（棒グラフ、折れ線グラフ）に希望はありますか？
2. 期間指定（過去1年、全期間など）の機能は必要ですか？
3. 他に表示したい統計はありますか？

**回答**: 積み上げ棒グラフで。期間は過去1年でよいです。そのほかは大丈夫です。

### Q5: 外部検索連携の詳細
**Yahoo ショッピング・楽天連携**:
```
Yahoo: https://shopping.yahoo.co.jp/search?p={都道府県名}+{特産品キーワード}
楽天: https://search.rakuten.co.jp/search/mall/{都道府県名}+{特産品キーワード}
```

**Perplexity連携**:
```
クエリ例: "{都道府県名}の美味しい特産品・グルメお取り寄せおすすめ"
```

**質問**:
1. 特産品キーワードは事前定義しますか？それともユーザー入力ですか？
2. 検索結果は新しいタブで開く形で良いですか？
3. よく使う検索パターンを保存する機能は必要ですか？

**回答**: 特に定義はふようです。結果は新しいタブを開いてください。パターンの検索は不要です。Perplexityを最優先の選択肢として、クエリの品質は高めると良いと思います。例えば特産・グルメの取り寄せや郷土料理もあっても良いと思います。クエリの送信先は以下の通りです。

`https://www.perplexity.ai/search?q={検索クエリ}`

### Q6: ゴミ箱機能の詳細
**提案する削除・復旧システム**:
1. **削除確認ダイアログ**: 「本当に削除しますか？」
2. **ゴミ箱**: 削除後30日間保持
3. **復旧機能**: ゴミ箱から選択して復旧
4. **完全削除**: 30日経過後または手動で完全削除

**質問**:
1. ゴミ箱の保持期間は30日で良いですか？
2. ゴミ箱の一覧表示機能は必要ですか？
3. 一括復旧・一括削除機能は必要ですか？

**回答**: 全部よいです！

### Q7: モバイル対応の詳細
**Tauri V2 モバイル対応**:
- **対象**: Android/iOS
- **制限**: iOS は開発者プログラム必要

**質問**:
1. モバイル版とデスクトップ版で機能差異は許容しますか？
2. タッチ操作に特化したUI調整は必要ですか？
3. カメラ機能（写真撮影）は必要ですか？

**回答**: 表示の違いは許容します。挙動など動作そのものは合理的な理由がなく許容されないです。UIはデスクトップとスマホとで変えて調整をしましょう。カメラはPCが使いづらいので無しで統一します。そしてユーザーはURLを入力することで画像を登録できます。

### Q8: エクスポート・インポート機能（優先度低）
**提案する機能**:
- **エクスポート**: JSON/CSV形式
- **インポート**: 同形式でのデータ復元
- **バックアップ**: 定期的な自動バックアップ

**質問**:
1. エクスポート形式の希望はありますか？
2. 写真URLの扱い（エクスポートに含める/含めない）は？
3. 部分的なインポート（特定期間のみ）は必要ですか？

**回答**: JSONにしましょう。URLもExportに含めます。全期間のExportのみでよいです。

## 次のステップ
回答いただいた後、以下を作成予定：
- 03_technical_hearing.md - Firebase設計・Tauri V2詳細
- 04_ui_ux_hearing.md - 画面設計・ユーザビリティ
- requirements_summary.md - 最終要件まとめ